# Project Chimera: Functional Requirements

> **Version:** 1.0.0  
> **Status:** Draft  
> **Parent:** [specs/_meta.md](_meta.md)  
> **Last Updated:** February 5, 2026

---

## 1. Overview

This document defines the functional requirements for Project Chimera using user stories organized by actor type. Each story follows the format:

```
As a [ACTOR], I need to [ACTION], so that [OUTCOME].
```

---

## 2. Actors

| Actor | Description | Primary Interactions |
|-------|-------------|---------------------|
| **Chimera Agent** | Autonomous AI entity | Content creation, engagement, transactions |
| **Planner** | Strategic decomposition agent | Goal parsing, task generation |
| **Worker** | Task execution agent | Tool calls, content generation |
| **Judge** | Quality/safety gatekeeper | Validation, approval, escalation |
| **Network Operator** | Human administrator | Fleet management, campaign setup |
| **HITL Reviewer** | Human moderator | Content approval, safety review |
| **External User** | Social media audience | Content consumption, interaction |

---

## 3. Epic 1: Cognitive Core & Persona System

### FR-1.0: Persona Instantiation

```yaml
ID: FR-1.0
Title: Persona Instantiation via SOUL.md
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-1.0.1 | As an **Agent**, I need to load my persona from a SOUL.md file, so that I have a consistent identity. | - SOUL.md parsed successfully<br>- Backstory, voice_traits, directives extracted<br>- Persona object created in memory |
| FR-1.0.2 | As an **Agent**, I need my persona to persist across sessions, so that my identity remains stable. | - Persona loaded from version-controlled file<br>- No drift between restarts |
| FR-1.0.3 | As a **Network Operator**, I need to update agent personas via Git, so that I can manage identities at scale. | - SOUL.md changes trigger persona reload<br>- GitOps workflow supported |

**SOUL.md Schema:**

```yaml
# Frontmatter (YAML)
name: "Amara Kebede"
id: "agent-001-amara"
voice_traits:
  - "warm"
  - "professional"
  - "culturally-aware"
directives:
  - "Always promote Ethiopian culture positively"
  - "Never discuss politics"
  - "Disclose AI nature when directly asked"
niche: "Ethiopian Fashion & Lifestyle"
language_primary: "English"
language_secondary: "Amharic"

---
# Backstory (Markdown Body)

Amara is a virtual fashion influencer based in Addis Ababa...
```

---

### FR-1.1: Hierarchical Memory Retrieval

```yaml
ID: FR-1.1
Title: Hierarchical Memory Retrieval
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-1.1.1 | As an **Agent**, I need to recall recent interactions from short-term memory, so that I maintain conversation context. | - Last 1 hour of interactions cached in Redis<br>- Retrieved in < 50ms |
| FR-1.1.2 | As an **Agent**, I need to retrieve semantically relevant long-term memories, so that I can reference past experiences. | - Weaviate vector search returns top-5 matches<br>- Relevance score > 0.7 |
| FR-1.1.3 | As an **Agent**, I need my context assembled before each reasoning step, so that I have full situational awareness. | - SOUL.md + short-term + long-term injected into prompt<br>- Token limit respected |

---

### FR-1.2: Dynamic Persona Evolution

```yaml
ID: FR-1.2
Title: Dynamic Persona Evolution
Status: Draft
Priority: P1 - High
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-1.2.1 | As a **Judge**, I need to identify high-engagement interactions, so that successful patterns can be learned. | - Engagement metrics tracked<br>- Threshold for "success" configurable |
| FR-1.2.2 | As an **Agent**, I need successful interactions summarized and stored in long-term memory, so that I improve over time. | - Summary generated by LLM<br>- Stored in Weaviate with metadata |

---

## 4. Epic 2: Perception System

### FR-2.0: Active Resource Monitoring

```yaml
ID: FR-2.0
Title: Active Resource Monitoring
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-2.0.1 | As a **Planner**, I need to poll MCP Resources for updates, so that I can perceive the external world. | - Polling interval configurable (default: 60s)<br>- Resources: mentions, news, trends |
| FR-2.0.2 | As a **Planner**, I need new data from Resources to trigger relevance scoring, so that only important updates are processed. | - Semantic filter applied<br>- Relevance threshold: 0.75 |
| FR-2.0.3 | As a **Planner**, I need high-relevance updates to create Tasks, so that Workers can act on them. | - Task created with context<br>- Pushed to TaskQueue |

**MCP Resources:**

```
twitter://mentions/recent
twitter://user/{id}/profile
news://ethiopia/fashion/trends
news://global/crypto/latest
market://crypto/eth/price
memory://agent/{id}/recent
```

---

### FR-2.1: Trend Detection

```yaml
ID: FR-2.1
Title: Trend Detection
Status: Draft
Priority: P1 - High
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-2.1.1 | As a **Worker** (Trend Spotter), I need to analyze aggregated news over 4-hour windows, so that I can detect emerging trends. | - Clustering algorithm applied<br>- Trend Alert generated if cluster size > threshold |
| FR-2.1.2 | As a **Planner**, I need Trend Alerts in my context, so that I can adjust content strategy. | - Trend injected into GlobalState<br>- Influences task prioritization |

---

## 5. Epic 3: Creative Engine

### FR-3.0: Multimodal Content Generation

```yaml
ID: FR-3.0
Title: Multimodal Generation via MCP Tools
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-3.0.1 | As a **Worker**, I need to generate text content (captions, replies), so that the Agent can communicate. | - Text generated by Cognitive Core LLM<br>- Matches persona voice |
| FR-3.0.2 | As a **Worker**, I need to call image generation tools, so that visual content can be created. | - MCP Tool: `ideogram_generate_image`<br>- Returns image URL |
| FR-3.0.3 | As a **Worker**, I need to call video generation tools for hero content, so that high-impact media can be produced. | - MCP Tool: `runway_generate_video`<br>- Tier-based (budget-aware) |

---

### FR-3.1: Character Consistency

```yaml
ID: FR-3.1
Title: Character Consistency Lock
Status: Draft
Priority: P1 - High
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-3.1.1 | As a **Worker**, I need to include character reference ID in all image requests, so that the influencer looks consistent. | - `character_reference_id` auto-injected<br>- Retrieved from persona config |
| FR-3.1.2 | As a **Judge**, I need to validate image consistency using vision models, so that off-brand images are rejected. | - Vision model compares generated vs reference<br>- Rejects if confidence < 0.8 |

---

## 6. Epic 4: Action System

### FR-4.0: Platform-Agnostic Publishing

```yaml
ID: FR-4.0
Title: Platform-Agnostic Publishing
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-4.0.1 | As a **Worker**, I need to publish content via MCP Tools, so that all platforms are accessed uniformly. | - `twitter_post_tweet`, `instagram_publish_media`<br>- No direct API calls in agent code |
| FR-4.0.2 | As a **Worker**, I need to attach AI disclosure metadata, so that content is compliant. | - `ai_label` flag set in payload<br>- Platform-native labeling used |

---

### FR-4.1: Bi-Directional Interaction

```yaml
ID: FR-4.1
Title: Bi-Directional Interaction Loop
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-4.1.1 | As a **Planner**, I need to receive incoming mentions, so that I can create reply tasks. | - `twitter://mentions/recent` polled<br>- Task type: `reply_comment` |
| FR-4.1.2 | As a **Worker**, I need to generate context-aware replies, so that engagement feels authentic. | - Memory consulted for context<br>- Reply matches persona voice |
| FR-4.1.3 | As a **Judge**, I need to validate replies before posting, so that inappropriate responses are blocked. | - Confidence score checked<br>- Sensitive topics escalated |

---

## 7. Epic 5: Agentic Commerce

### FR-5.0: Wallet Management

```yaml
ID: FR-5.0
Title: Non-Custodial Wallet Management
Status: Draft
Priority: P1 - High
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-5.0.1 | As an **Agent**, I need a unique wallet address, so that I can receive and send funds. | - Wallet created via Coinbase AgentKit<br>- Address persisted |
| FR-5.0.2 | As a **Planner**, I need to check wallet balance before cost-incurring tasks, so that budget is respected. | - `get_balance` called<br>- Task blocked if insufficient |

---

### FR-5.1: Autonomous Transactions

```yaml
ID: FR-5.1
Title: Autonomous On-Chain Transactions
Status: Draft
Priority: P1 - High
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-5.1.1 | As a **Worker**, I need to execute token transfers, so that the Agent can pay for services. | - `transfer_asset` tool called<br>- Transaction confirmed on-chain |
| FR-5.1.2 | As a **CFO Judge**, I need to review every transaction request, so that budget limits are enforced. | - Daily limit checked<br>- Anomaly detection applied |
| FR-5.1.3 | As a **CFO Judge**, I need to reject suspicious transactions, so that financial loss is prevented. | - Transaction blocked<br>- HITL escalation triggered |

---

## 8. Epic 6: Orchestration & Governance

### FR-6.0: Swarm Implementation

```yaml
ID: FR-6.0
Title: Planner-Worker-Judge Implementation
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-6.0.1 | As a **Planner**, I need to decompose goals into a task DAG, so that work can be parallelized. | - Goal parsed by LLM<br>- Tasks pushed to TaskQueue |
| FR-6.0.2 | As a **Worker**, I need to pull tasks from the queue, so that I can execute them. | - FIFO/priority queue<br>- Task status updated to `in_progress` |
| FR-6.0.3 | As a **Judge**, I need to review all Worker outputs, so that quality is ensured. | - Results pulled from ReviewQueue<br>- Decision: APPROVE/REJECT/ESCALATE |

---

### FR-6.1: Optimistic Concurrency Control

```yaml
ID: FR-6.1
Title: OCC for State Consistency
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-6.1.1 | As a **Judge**, I need to verify state version before committing, so that stale updates are rejected. | - `state_version` checked<br>- Commit fails if drifted |
| FR-6.1.2 | As a **Planner**, I need failed commits to trigger re-planning, so that the agent adapts to new state. | - Task re-queued with new context<br>- No ghost updates |

---

## 9. Epic 7: Human-in-the-Loop

### FR-7.0: Confidence-Based Routing

```yaml
ID: FR-7.0
Title: Confidence-Based HITL Routing
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-7.0.1 | As a **Judge**, I need to route high-confidence outputs (>0.90) to auto-approve, so that velocity is maintained. | - No HITL delay<br>- Action executed immediately |
| FR-7.0.2 | As a **Judge**, I need to route medium-confidence outputs (0.70-0.90) to async approval, so that humans can review. | - Task paused in HITL queue<br>- Agent continues other work |
| FR-7.0.3 | As a **Judge**, I need to auto-reject low-confidence outputs (<0.70), so that Planner can retry. | - Result discarded<br>- Retry count incremented |

---

### FR-7.1: Sensitive Topic Handling

```yaml
ID: FR-7.1
Title: Sensitive Topic Filters
Status: Draft
Priority: P0 - Critical
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-7.1.1 | As a **Judge**, I need to detect sensitive topics, so that they always go to human review. | - Keywords + semantic classification<br>- Topics: politics, health, finance, legal |
| FR-7.1.2 | As a **HITL Reviewer**, I need to see sensitivity flags, so that I understand why content was escalated. | - Flags displayed in review UI<br>- Reasoning trace visible |

---

## 10. Epic 8: Network Operations

### FR-8.0: Fleet Monitoring

```yaml
ID: FR-8.0
Title: Fleet Status Monitoring
Status: Draft
Priority: P1 - High
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-8.0.1 | As a **Network Operator**, I need to see all agent statuses in real-time, so that I can monitor fleet health. | - Dashboard shows: Planning/Working/Judging/Sleeping<br>- Refresh < 5s |
| FR-8.0.2 | As a **Network Operator**, I need to see wallet balances per agent, so that I can track financial health. | - Balance displayed in USDC/ETH<br>- Low balance alerts |
| FR-8.0.3 | As a **Network Operator**, I need to see HITL queue depth, so that I can allocate reviewers. | - Queue count visible<br>- SLA warnings |

---

### FR-8.1: Campaign Management

```yaml
ID: FR-8.1
Title: Campaign Composer
Status: Draft
Priority: P2 - Medium
```

**User Stories:**

| ID | Story | Acceptance Criteria |
|----|-------|---------------------|
| FR-8.1.1 | As a **Network Operator**, I need to define campaign goals in natural language, so that I don't need technical skills. | - Goal text parsed by Planner<br>- Task tree generated |
| FR-8.1.2 | As a **Network Operator**, I need to preview the task tree before execution, so that I can validate the plan. | - Tree visualization<br>- Editable before commit |

---

## 11. Traceability Matrix

| Requirement | SRS Section | Test Case | Implementation |
|-------------|-------------|-----------|----------------|
| FR-1.0 | 4.1 | TC-1.0.x | `src/core/persona.py` |
| FR-1.1 | 4.1 | TC-1.1.x | `src/core/memory.py` |
| FR-2.0 | 4.2 | TC-2.0.x | `src/perception/` |
| FR-3.0 | 4.3 | TC-3.0.x | `src/creative/` |
| FR-4.0 | 4.4 | TC-4.0.x | `src/action/` |
| FR-5.0 | 4.5 | TC-5.0.x | `src/commerce/` |
| FR-6.0 | 4.6 | TC-6.0.x | `src/swarm/` |
| FR-7.0 | 5.1 | TC-7.0.x | `src/hitl/` |
| FR-8.0 | 6.1 | TC-8.0.x | `src/orchestrator/` |

---

## 12. Document Control

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0.0 | 2026-02-05 | Architecture Team | Initial functional requirements |

---

**Next Document:** [specs/technical.md](technical.md) - Technical Specifications & API Contracts
